"use strict";
const navBar = document.querySelector(".main-nav");
window.addEventListener("scroll", () => {
  const pageScroll = window.scrollY;
  console.log(pageScroll);
  pageScroll > 700
    ? navBar.classList.add("fixed")
    : navBar.classList.remove("fixed");
});
const menuButton = document.querySelector(".menu-button"),
  navLinks = document.querySelector(".nav-links");
menuButton.addEventListener("click", () => {
  (navLinks.style.display = "flex"),
    setTimeout(() => {
      navLinks.style.opacity = 1;
    }, 0);
}),
  navLinks.addEventListener("click", () => {
    (navLinks.style.opacity = 0),
      setTimeout(() => {
        navLinks.style.display = "none";
      }, 500);
  });
const gallery = document.querySelector(".gallery"),
  galleryNav = document.querySelector(".gallery-nav");
galleryNav.addEventListener("click", (e) => {
  if ("BUTTON" == e.target.nodeName) {
    let t = e.target,
      a = document.querySelectorAll(".gallery-nav li");
    a.forEach((e) => e.classList.remove("active")),
      t.parentElement.classList.toggle("active"),
      gallery.setAttribute("data-category", t.dataset.category);
  }
}),
  $(".owl-carousel").owlCarousel({
    loop: !0,
    margin: 10,
    items: 1,
    autoplay: !0,
    autoplayTimeout: 1e4,
    autoplayHoverPause: !0,
    center: !0,
    dots: !1,
  });

const galleryGrid = document.querySelector(".gallery-grid");
const imgWrappers = document.querySelectorAll(".gallery-grid .img-wrapper");
const galleryViewBox = document.querySelector(".gallery-view-box");
const viewBoxImg = galleryViewBox.querySelector("img");

function showImg(imgWrapper) {
  if (document.querySelector(".img-wrapper.active")) {
    document.querySelector(".img-wrapper.active").classList.remove("active");
  }
  imgWrapper.classList.add("active");
  const imgDiv = imgWrapper.querySelector(".img");
  const imgPath = getComputedStyle(imgDiv).backgroundImage.match(
    /images\/\w*-[0-9].\w*/
  )[0];

  galleryViewBox.style.display = "flex";
  viewBoxImg.setAttribute("src", imgPath);
  document.body.style.overflow = "hidden";
}

galleryGrid.addEventListener("click", (e) => {
  if (e.target.classList.contains("img-wrapper")) {
    showImg(e.target);
  }
});
galleryViewBox.addEventListener("click", (e) => {
  if (
    e.target.classList.contains("gallery-view-box") ||
    e.target.classList.contains("close")
  ) {
    galleryViewBox.style.display = "none";
    document.body.style.overflow = "auto";
  }
});
const nextIcon = document.querySelector(".gallery-view-box i.left");
function showNextImg() {
  const activeImgWrapper = document.querySelector(".img-wrapper.active");
  activeImgWrapper.nextElementSibling
    ? showImg(activeImgWrapper.nextElementSibling)
    : showImg(imgWrappers[0]);
}
nextIcon.addEventListener("click", showNextImg);
const prevIcon = document.querySelector(".gallery-view-box i.right");
function showPrevImg() {
  const activeImgWrapper = document.querySelector(".img-wrapper.active");
  activeImgWrapper.previousElementSibling
    ? showImg(activeImgWrapper.previousElementSibling)
    : showImg(imgWrappers[imgWrappers.length - 1]);
}
prevIcon.addEventListener("click", showPrevImg);

let touchStartX = 0;
galleryViewBox.addEventListener("touchstart", (e) => {
  touchStartX = e.changedTouches[0].screenX;
});
let touchEndX = 0;
galleryViewBox.addEventListener("touchend", (e) => {
  touchEndX = e.changedTouches[0].screenX;
  if (touchEndX < touchStartX) {
    showNextImg();
  }
  if (touchEndX > touchStartX) {
    showPrevImg();
  }
});

const loadScreen = document.querySelector(".loading-screen");
window.addEventListener("load", () => {
  loadScreen.style.opacity = 0;
  setTimeout(() => {
    loadScreen.style.display = "none";
  }, 700);
});
